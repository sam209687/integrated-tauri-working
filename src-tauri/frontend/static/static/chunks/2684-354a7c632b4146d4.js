(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2684],{16588:(e,r,a)=>{"use strict";a.d(r,{b:()=>l});var t=a(34477);let l=(0,t.createServerReference)("7ff82737d0d85f954df8c07bcb1a20788f82e31a4e",t.callServer,void 0,t.findSourceMapURL,"getCategories")},19946:(e,r,a)=>{"use strict";a.d(r,{A:()=>u});var t=a(12115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),s=e=>{let r=c(e);return r.charAt(0).toUpperCase()+r.slice(1)},d=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()},n=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,r)=>{let{color:a="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:s,className:o="",children:u,iconNode:f,...p}=e;return(0,t.createElement)("svg",{ref:r,...i,width:l,height:l,stroke:a,strokeWidth:s?24*Number(c)/Number(l):c,className:d("lucide",o),...!u&&!n(p)&&{"aria-hidden":"true"},...p},[...f.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(u)?u:[u]])}),u=(e,r)=>{let a=(0,t.forwardRef)((a,c)=>{let{className:n,...i}=a;return(0,t.createElement)(o,{ref:c,iconNode:r,className:d("lucide-".concat(l(s(e))),"lucide-".concat(e),n),...i})});return a.displayName=s(e),a}},27238:(e,r,a)=>{"use strict";a.d(r,{default:()=>_});var t=a(95155),l=a(12115),c=a(62177),s=a(35695),d=a(63560),n=a(56671),i=a(51154),o=a(34477);let u=(0,o.createServerReference)("7fd33461ff0dffdf950ef9c621f0fbcb809aceccf3",o.callServer,void 0,o.findSourceMapURL,"generateProductCodeForUI"),f=(0,o.createServerReference)("7f1bfac511e8709b6c0bc6e41648bc569dc9b6248f",o.callServer,void 0,o.findSourceMapURL,"updateProduct"),p=(0,o.createServerReference)("7fc59ff7c5457f88a79456c819509b55943b6a7fd9",o.callServer,void 0,o.findSourceMapURL,"createProduct");var x=a(99919),h=a(65453),g=a(6079),m=a(16588);let v=(0,o.createServerReference)("7fba64ca08bf31a7ceebf519fb4dc0be6a02763d02",o.callServer,void 0,o.findSourceMapURL,"getBrands"),j=(0,o.createServerReference)("7fcbb0811968e2c772e207e9819ec78cc119c51d9d",o.callServer,void 0,o.findSourceMapURL,"getTaxes"),b=(0,o.createServerReference)("7f824227ec4864cd93d947cf61f5da38cbd30a28e9",o.callServer,void 0,o.findSourceMapURL,"getCurrencySymbol"),S=(0,h.v)(e=>({products:[],categories:[],brands:[],taxes:[],isLoading:!1,currencySymbol:"₹",fetchProducts:async()=>{e({isLoading:!0});try{let r=await (0,g.d)();r.success?e({products:r.data,isLoading:!1}):(n.oR.error(r.message),e({isLoading:!1,products:[]}))}catch(r){console.error("Failed to fetch products:",r),e({isLoading:!1,products:[]})}},fetchFormData:async()=>{e({isLoading:!0});try{let[r,a,t,l]=await Promise.all([(0,m.b)(),v(),j(),b()]);e({categories:r.success?r.data:[],brands:a.success?a.data:[],taxes:t.success?t.data:[],currencySymbol:l.success?l.data:"₹",isLoading:!1})}catch(r){console.error("Failed to fetch form data:",r),e({isLoading:!1})}},addProduct:r=>{e(e=>({products:[...e.products,r]}))},updateProduct:r=>{e(e=>({products:e.products.map(e=>e._id===r._id?r:e)}))},removeProduct:r=>{e(e=>({products:e.products.filter(e=>e._id!==r)}))}}));var y=a(30285),C=a(17759),R=a(62523),w=a(59409),N=a(22346),P=a(59434);function L(e){let{className:r,...a}=e;return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,P.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...a})}let _=e=>{var r,a,o,h,g,m,v,j,b;let{initialData:P}=e,_=(0,s.useRouter)(),[M,k]=(0,l.useTransition)(),[U,z]=(0,l.useState)(!1),{categories:A,brands:B,taxes:I,fetchFormData:E,isLoading:J}=S(),V=!!P,F="w-full [appearance:textfield] [&::-webkit-outer-spin-button]:m-0 [&::-webkit-inner-spin-button]:m-0",O=(0,c.mN)({resolver:(0,d.u)(x.HU),defaultValues:{category:(null==P||null==(a=P.category)||null==(r=a._id)?void 0:r.toString())||(null==P||null==(o=P.category)?void 0:o.toString())||"",brand:(null==P||null==(g=P.brand)||null==(h=g._id)?void 0:h.toString())||(null==P||null==(m=P.brand)?void 0:m.toString())||"",productCode:(null==P?void 0:P.productCode)||"",productName:(null==P?void 0:P.productName)||"",description:(null==P?void 0:P.description)||"",tax:(null==P||null==(j=P.tax)||null==(v=j._id)?void 0:v.toString())||(null==P||null==(b=P.tax)?void 0:b.toString())||"",purchasePrice:(null==P?void 0:P.purchasePrice)||0,sellingPrice:(null==P?void 0:P.sellingPrice)||0}}),{watch:$,setValue:q}=O,D=$("category");(0,l.useEffect)(()=>{E()},[E]),(0,l.useEffect)(()=>{D&&!V&&(z(!0),(async()=>{try{let e=await u(D);e.success&&e.data?q("productCode",e.data):n.oR.error(e.message||"Failed to generate product code.")}catch(e){n.oR.error("Error generating product code."),console.error(e)}finally{z(!1)}})())},[D,q,V]);let T=async e=>{k(async()=>{let r={...e,productCode:e.productCode||""},a=V?await f(P._id,r):await p(r);a.success?(n.oR.success(a.message),_.push("/admin/products")):n.oR.error(a.message)})};return J?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(i.A,{className:"h-8 w-8 animate-spin"})}):(0,t.jsx)(C.lV,{...O,children:(0,t.jsxs)("form",{onSubmit:O.handleSubmit(T),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"productName",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Name"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{placeholder:"e.g., Sunflower Oil",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"category",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Category"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a category"})})}),(0,t.jsx)(w.gC,{children:A.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"brand",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Brand"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a brand"})})}),(0,t.jsx)(w.gC,{children:B.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"description",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Description"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(L,{placeholder:"Describe the product...",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"tax",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Tax"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a tax"})})}),(0,t.jsx)(w.gC,{children:I.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsx)(N.Separator,{className:"my-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mt-6",children:"Inventory & Pricing"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"productCode",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Code"}),(0,t.jsx)(C.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(R.p,{...r,disabled:!0,className:"pr-8"}),U&&(0,t.jsx)(i.A,{className:"absolute right-2 top-2 h-4 w-4 animate-spin text-gray-400"})]})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"purchasePrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Purchase Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"sellingPrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Selling / Board Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-8",children:[(0,t.jsx)(y.$,{type:"button",variant:"outline",onClick:()=>_.back(),disabled:M,children:"Cancel"}),(0,t.jsx)(y.$,{type:"submit",disabled:M,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait..."]}):V?"Update Product":"Add Product"})]})]})})}},34477:(e,r,a)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var a in r)Object.defineProperty(e,a,{enumerable:!0,get:r[a]})}(r,{callServer:function(){return t.callServer},createServerReference:function(){return c},findSourceMapURL:function(){return l.findSourceMapURL}});let t=a(53806),l=a(31818),c=a(34979).createServerReference},45312:(e,r,a)=>{Promise.resolve().then(a.bind(a,27238))},51154:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},87489:(e,r,a)=>{"use strict";a.d(r,{b:()=>i});var t=a(12115),l=a(63655),c=a(95155),s="horizontal",d=["horizontal","vertical"],n=t.forwardRef((e,r)=>{var a;let{decorative:t,orientation:n=s,...i}=e,o=(a=n,d.includes(a))?n:s;return(0,c.jsx)(l.sG.div,{"data-orientation":o,...t?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...i,ref:r})});n.displayName="Separator";var i=n}}]);