(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{13717:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},19946:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(12115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:h,...m}=e;return(0,a.createElement)("svg",{ref:t,...d,width:s,height:s,stroke:r,strokeWidth:l?24*Number(n)/Number(s):n,className:i("lucide",c),...!u&&!o(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:o,...d}=r;return(0,a.createElement)(c,{ref:n,iconNode:t,className:i("lucide-".concat(s(l(e))),"lucide-".concat(e),o),...d})});return r.displayName=l(e),r}},27038:(e,t,r)=>{Promise.resolve().then(r.bind(r,55820))},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>o,r:()=>i});var a=r(95155);r(12115);var s=r(99708),n=r(74466),l=r(59434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:r,size:n,asChild:o=!1,...d}=e,c=o?s.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,l.cn)(i({variant:r,size:n,className:t})),...d})}},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"redirect")&&r.d(t,{redirect:function(){return a.redirect}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},37349:(e,t,r)=>{"use strict";r.d(t,{Lt:()=>P,Rx:()=>I,Zr:()=>V,EO:()=>F,$v:()=>H,ck:()=>M,wd:()=>T,r7:()=>X,tv:()=>L});var a=r(95155),s=r(12115),n=r(46081),l=r(6101),i=r(15452),o=r(85185),d=r(99708),c="AlertDialog",[u,h]=(0,n.A)(c,[i.Hs]),m=(0,i.Hs)(),g=e=>{let{__scopeAlertDialog:t,...r}=e,s=m(t);return(0,a.jsx)(i.bL,{...s,...r,modal:!0})};g.displayName=c;var x=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=m(r);return(0,a.jsx)(i.l9,{...n,...s,ref:t})});x.displayName="AlertDialogTrigger";var f=e=>{let{__scopeAlertDialog:t,...r}=e,s=m(t);return(0,a.jsx)(i.ZL,{...s,...r})};f.displayName="AlertDialogPortal";var p=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=m(r);return(0,a.jsx)(i.hJ,{...n,...s,ref:t})});p.displayName="AlertDialogOverlay";var v="AlertDialogContent",[y,b]=u(v),j=(0,d.Dc)("AlertDialogContent"),w=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:n,...d}=e,c=m(r),u=s.useRef(null),h=(0,l.s)(t,u),g=s.useRef(null);return(0,a.jsx)(i.G$,{contentName:v,titleName:k,docsSlug:"alert-dialog",children:(0,a.jsx)(y,{scope:r,cancelRef:g,children:(0,a.jsxs)(i.UC,{role:"alertdialog",...c,...d,ref:h,onOpenAutoFocus:(0,o.mK)(d.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=g.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(j,{children:n}),(0,a.jsx)(D,{contentRef:u})]})})})});w.displayName=v;var k="AlertDialogTitle",N=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=m(r);return(0,a.jsx)(i.hE,{...n,...s,ref:t})});N.displayName=k;var A="AlertDialogDescription",E=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=m(r);return(0,a.jsx)(i.VY,{...n,...s,ref:t})});E.displayName=A;var C=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=m(r);return(0,a.jsx)(i.bm,{...n,...s,ref:t})});C.displayName="AlertDialogAction";var _="AlertDialogCancel",R=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,{cancelRef:n}=b(_,r),o=m(r),d=(0,l.s)(t,n);return(0,a.jsx)(i.bm,{...o,...s,ref:d})});R.displayName=_;var D=e=>{let{contentRef:t}=e,r="`".concat(v,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(v,"` by passing a `").concat(A,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(v,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return s.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},S=r(59434),O=r(30285);function P(e){let{...t}=e;return(0,a.jsx)(g,{"data-slot":"alert-dialog",...t})}function L(e){let{...t}=e;return(0,a.jsx)(x,{"data-slot":"alert-dialog-trigger",...t})}function z(e){let{...t}=e;return(0,a.jsx)(f,{"data-slot":"alert-dialog-portal",...t})}function $(e){let{className:t,...r}=e;return(0,a.jsx)(p,{"data-slot":"alert-dialog-overlay",className:(0,S.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function F(e){let{className:t,...r}=e;return(0,a.jsxs)(z,{children:[(0,a.jsx)($,{}),(0,a.jsx)(w,{"data-slot":"alert-dialog-content",className:(0,S.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r})]})}function T(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,S.cn)("flex flex-col gap-2 text-center sm:text-left",t),...r})}function M(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,S.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function X(e){let{className:t,...r}=e;return(0,a.jsx)(N,{"data-slot":"alert-dialog-title",className:(0,S.cn)("text-lg font-semibold",t),...r})}function H(e){let{className:t,...r}=e;return(0,a.jsx)(E,{"data-slot":"alert-dialog-description",className:(0,S.cn)("text-muted-foreground text-sm",t),...r})}function I(e){let{className:t,...r}=e;return(0,a.jsx)(C,{className:(0,S.cn)((0,O.r)(),t),...r})}function V(e){let{className:t,...r}=e;return(0,a.jsx)(R,{className:(0,S.cn)((0,O.r)({variant:"outline"}),t),...r})}},55820:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var a=r(95155),s=r(12115),n=r(85127);function l(e){let{data:t,columns:r,renderActions:s,rowKey:l,renderRowWrapper:i}=e;return(0,a.jsx)("div",{className:"rounded-md border bg-white dark:bg-gray-800 shadow-sm",children:(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{className:"bg-gray-50 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[r.map((e,t)=>(0,a.jsx)(n.nd,{className:"text-gray-700 dark:text-gray-200",children:e.header},e.key.toString()+t)),s&&(0,a.jsx)(n.nd,{className:"text-gray-700 dark:text-gray-200 text-right",children:"Actions"})]})}),(0,a.jsx)(n.BF,{children:0===t.length?(0,a.jsx)(n.Hj,{children:(0,a.jsx)(n.nA,{colSpan:r.length+ +!!s,className:"h-24 text-center text-gray-500 dark:text-gray-400",children:"No data available."})}):t.map(e=>{let t=(0,a.jsxs)(a.Fragment,{children:[r.map((t,r)=>(0,a.jsx)(n.nA,{className:"text-gray-800 dark:text-gray-100",children:t.render?t.render(e):e[t.key]},t.key.toString()+r)),s&&(0,a.jsx)(n.nA,{className:"text-right whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex justify-end space-x-2",children:s(e)})})]});return i?i(e,t):(0,a.jsx)(n.Hj,{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:t},e[l])})})]})})}var i=r(30285),o=r(13717),d=r(62525);let c=(0,r(19946).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var u=r(84616),h=r(6874),m=r.n(h),g=r(35695),x=r(56671),f=r(37349),p=r(59434);function v(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[h,v]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),[j,w]=(0,s.useState)(null),[k,N]=(0,s.useState)({}),A=(0,g.useSearchParams)().get("highlight"),E=(0,s.useRef)({});(0,s.useEffect)(()=>{(async()=>{try{n(!0);let e=await fetch("/api/cashier");if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to fetch cashiers")}let r=(await e.json()).map((e,t)=>({...e,sNo:t+1}));t(r)}catch(t){let e=t instanceof Error?t.message:"Error fetching cashiers.";v(e),x.oR.error(e)}finally{n(!1)}})()},[]),(0,s.useEffect)(()=>{if(A&&e.length>0){let e=E.current[A];if(e){e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-yellow-100","dark:bg-yellow-900","animate-pulse");let t=setTimeout(()=>{e.classList.remove("bg-yellow-100","dark:bg-yellow-900","animate-pulse")},3e3);return()=>clearTimeout(t)}}},[e,A]),(0,s.useEffect)(()=>{let e=setInterval(()=>{N(e=>{let t={...e};for(let e in t)new Date>t[e].expiresAt&&delete t[e];return t})},1e4);return()=>clearInterval(e)},[]);let C=[{key:"sNo",header:"S/No"},{key:"name",header:"Name"},{key:"aadhaar",header:"Aadhaar",render:e=>"XXXXXXXX".concat(e.aadhaar.slice(-4))},{key:"status",header:"Status",render:e=>(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("active"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})},{key:"email",header:"Login Email"},{key:"personalEmail",header:"Personal Email"},{key:"phone",header:"Phone"},{key:"storeLocation",header:"Store Location"}],_=async e=>{if(confirm("Are you sure you want to delete this cashier?"))try{let r=await fetch("/api/cashier/".concat(e),{method:"DELETE"});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to delete cashier")}x.oR.success("Cashier deleted successfully."),t(t=>t.filter(t=>t._id!==e))}catch(t){let e=t instanceof Error?t.message:"Error deleting cashier.";x.oR.error(e)}},R=e=>{w(e),b(!0)},D=async()=>{if(j)try{let e=await fetch("/api/admin/cashier-reset-initiate/".concat(j),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to initiate cashier password reset")}let t=await e.json();x.oR.success(t.message||"Password reset OTP generated. Displaying on screen."),N(e=>({...e,[j]:{otp:t.otp,expiresAt:new Date(t.otpExpires)}}))}catch(t){let e=t instanceof Error?t.message:"Error resetting password.";x.oR.error(e)}finally{w(null),b(!1)}},S=j?e.find(e=>e._id===j):null;return r?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-64px)]",children:"Loading cashiers..."}):h?(0,a.jsxs)("div",{className:"text-red-500 text-center min-h-[calc(100vh-64px)]",children:["Error: ",h]}):(0,a.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Manage Cashiers"}),(0,a.jsx)(m(),{href:"/admin/manage-cashiers/add",children:(0,a.jsxs)(i.$,{children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Add Cashier"]})})]}),(0,a.jsx)(l,{data:e,columns:C,renderActions:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-blue-600",children:(0,a.jsx)(m(),{href:"/admin/manage-cashiers/edit/".concat(e._id),title:"Edit Cashier",children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-red-600",onClick:()=>_(e._id),children:(0,a.jsx)(d.A,{className:"h-4 w-4"})}),k[e._id]&&new Date<k[e._id].expiresAt?(0,a.jsxs)("div",{className:"relative flex items-center justify-center space-x-1 px-2 py-1 text-sm font-bold text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900 rounded-md",children:[(0,a.jsx)("span",{children:k[e._id].otp}),(0,a.jsxs)("span",{className:"text-xs font-normal bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full px-1 py-0.5 ml-1",children:[Math.ceil((k[e._id].expiresAt.getTime()-new Date().getTime())/6e4),"m"]})]}):(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-yellow-600",onClick:()=>R(e._id),children:(0,a.jsx)(c,{className:"h-4 w-4"})})]}),rowKey:"_id",renderRowWrapper:(e,t)=>(0,a.jsx)("tr",{ref:t=>{E.current[e._id]=t},className:(0,p.cn)("transition-all duration-300",A===e._id?"bg-yellow-100 dark:bg-yellow-900":""),children:t},e._id)}),(0,a.jsx)(f.Lt,{open:y,onOpenChange:b,children:(0,a.jsxs)(f.EO,{children:[(0,a.jsxs)(f.wd,{children:[(0,a.jsx)(f.r7,{children:"Are you sure you want to reset password?"}),(0,a.jsxs)(f.$v,{children:["This action will generate a new OTP visible here for 1 hour.",(0,a.jsxs)("span",{className:"font-semibold text-blue-600 dark:text-blue-400 ml-1",children:["(",(null==S?void 0:S.personalEmail)||(null==S?void 0:S.email)||"selected cashier",")"]})]})]}),(0,a.jsxs)(f.ck,{children:[(0,a.jsx)(f.Zr,{onClick:()=>w(null),children:"Cancel"}),(0,a.jsx)(f.Rx,{onClick:D,children:"Confirm Reset"})]})]})})]})}},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(52596),s=r(39688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},62525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},74466:(e,t,r)=>{"use strict";r.d(t,{F:()=>l});var a=r(52596);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=a.$,l=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return n(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:i}=t,o=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],a=null==i?void 0:i[e];if(null===t)return null;let n=s(t)||s(a);return l[e][n]}),d=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return n(e,o,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...d}[t]):({...i,...d})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},84616:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},85127:(e,t,r)=>{"use strict";r.d(t,{A0:()=>l,BF:()=>i,Hj:()=>o,XI:()=>n,nA:()=>c,nd:()=>d});var a=r(95155);r(12115);var s=r(59434);function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",t),...r})})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",t),...r})}function i(e){let{className:t,...r}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",t),...r})}function o(e){let{className:t,...r}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 *:[[role=checkbox]]:translate-y-0.5",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 *:[[role=checkbox]]:translate-y-0.5",t),...r})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2848,6671,7849,2898,6874,5452,8441,1684,7358],()=>t(27038)),_N_E=e.O()}]);