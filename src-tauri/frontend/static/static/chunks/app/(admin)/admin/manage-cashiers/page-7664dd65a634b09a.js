(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{2500:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(95155),s=a(12115),n=a(85127);function l(e){let{data:t,columns:a,renderActions:s,rowKey:l,renderRowWrapper:i}=e;return(0,r.jsx)("div",{className:"rounded-md border bg-white dark:bg-gray-800 shadow-sm",children:(0,r.jsxs)(n.XI,{children:[(0,r.jsx)(n.A0,{children:(0,r.jsxs)(n.Hj,{className:"bg-gray-50 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[a.map((e,t)=>(0,r.jsx)(n.nd,{className:"text-gray-700 dark:text-gray-200",children:e.header},e.key.toString()+t)),s&&(0,r.jsx)(n.nd,{className:"text-gray-700 dark:text-gray-200 text-right",children:"Actions"})]})}),(0,r.jsx)(n.BF,{children:0===t.length?(0,r.jsx)(n.Hj,{children:(0,r.jsx)(n.nA,{colSpan:a.length+ +!!s,className:"h-24 text-center text-gray-500 dark:text-gray-400",children:"No data available."})}):t.map(e=>{let t=(0,r.jsxs)(r.Fragment,{children:[a.map((t,a)=>(0,r.jsx)(n.nA,{className:"text-gray-800 dark:text-gray-100",children:t.render?t.render(e):e[t.key]},t.key.toString()+a)),s&&(0,r.jsx)(n.nA,{className:"text-right whitespace-nowrap",children:(0,r.jsx)("div",{className:"flex justify-end space-x-2",children:s(e)})})]});return i?i(e,t):(0,r.jsx)(n.Hj,{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:t},e[l])})})]})})}var i=a(30285),o=a(13717),d=a(62525),c=a(40133),h=a(84616),u=a(6874),x=a.n(u),g=a(35695),m=a(56671),f=a(90010),p=a(59434);function b(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),[u,b]=(0,s.useState)(null),[v,j]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null),[k,N]=(0,s.useState)({}),E=(0,g.useSearchParams)().get("highlight"),_=(0,s.useRef)({});(0,s.useEffect)(()=>{(async()=>{try{n(!0);let e=await fetch("/api/cashier");if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to fetch cashiers")}let a=(await e.json()).map((e,t)=>({...e,sNo:t+1}));t(a)}catch(t){let e=t instanceof Error?t.message:"Error fetching cashiers.";b(e),m.oR.error(e)}finally{n(!1)}})()},[]),(0,s.useEffect)(()=>{if(E&&e.length>0){let e=_.current[E];if(e){e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-yellow-100","dark:bg-yellow-900","animate-pulse");let t=setTimeout(()=>{e.classList.remove("bg-yellow-100","dark:bg-yellow-900","animate-pulse")},3e3);return()=>clearTimeout(t)}}},[e,E]),(0,s.useEffect)(()=>{let e=setInterval(()=>{N(e=>{let t={...e};for(let e in t)new Date>t[e].expiresAt&&delete t[e];return t})},1e4);return()=>clearInterval(e)},[]);let A=[{key:"sNo",header:"S/No"},{key:"name",header:"Name"},{key:"aadhaar",header:"Aadhaar",render:e=>"XXXXXXXX".concat(e.aadhaar.slice(-4))},{key:"status",header:"Status",render:e=>(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("active"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})},{key:"email",header:"Login Email"},{key:"personalEmail",header:"Personal Email"},{key:"phone",header:"Phone"},{key:"storeLocation",header:"Store Location"}],C=async e=>{if(confirm("Are you sure you want to delete this cashier?"))try{let a=await fetch("/api/cashier/".concat(e),{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to delete cashier")}m.oR.success("Cashier deleted successfully."),t(t=>t.filter(t=>t._id!==e))}catch(t){let e=t instanceof Error?t.message:"Error deleting cashier.";m.oR.error(e)}},S=e=>{w(e),j(!0)},z=async()=>{if(y)try{let e=await fetch("/api/admin/cashier-reset-initiate/".concat(y),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to initiate cashier password reset")}let t=await e.json();m.oR.success(t.message||"Password reset OTP generated. Displaying on screen."),N(e=>({...e,[y]:{otp:t.otp,expiresAt:new Date(t.otpExpires)}}))}catch(t){let e=t instanceof Error?t.message:"Error resetting password.";m.oR.error(e)}finally{w(null),j(!1)}},L=y?e.find(e=>e._id===y):null;return a?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-64px)]",children:"Loading cashiers..."}):u?(0,r.jsxs)("div",{className:"text-red-500 text-center min-h-[calc(100vh-64px)]",children:["Error: ",u]}):(0,r.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Manage Cashiers"}),(0,r.jsx)(x(),{href:"/admin/manage-cashiers/add",children:(0,r.jsxs)(i.$,{children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Add Cashier"]})})]}),(0,r.jsx)(l,{data:e,columns:A,renderActions:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-blue-600",children:(0,r.jsx)(x(),{href:"/admin/manage-cashiers/edit/".concat(e._id),title:"Edit Cashier",children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-red-600",onClick:()=>C(e._id),children:(0,r.jsx)(d.A,{className:"h-4 w-4"})}),k[e._id]&&new Date<k[e._id].expiresAt?(0,r.jsxs)("div",{className:"relative flex items-center justify-center space-x-1 px-2 py-1 text-sm font-bold text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900 rounded-md",children:[(0,r.jsx)("span",{children:k[e._id].otp}),(0,r.jsxs)("span",{className:"text-xs font-normal bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full px-1 py-0.5 ml-1",children:[Math.ceil((k[e._id].expiresAt.getTime()-new Date().getTime())/6e4),"m"]})]}):(0,r.jsx)(i.$,{variant:"ghost",size:"icon",className:"hover:text-yellow-600",onClick:()=>S(e._id),children:(0,r.jsx)(c.A,{className:"h-4 w-4"})})]}),rowKey:"_id",renderRowWrapper:(e,t)=>(0,r.jsx)("tr",{ref:t=>{_.current[e._id]=t},className:(0,p.cn)("transition-all duration-300",E===e._id?"bg-yellow-100 dark:bg-yellow-900":""),children:t},e._id)}),(0,r.jsx)(f.Lt,{open:v,onOpenChange:j,children:(0,r.jsxs)(f.EO,{children:[(0,r.jsxs)(f.wd,{children:[(0,r.jsx)(f.r7,{children:"Are you sure you want to reset password?"}),(0,r.jsxs)(f.$v,{children:["This action will generate a new OTP visible here for 1 hour.",(0,r.jsxs)("span",{className:"font-semibold text-blue-600 dark:text-blue-400 ml-1",children:["(",(null==L?void 0:L.personalEmail)||(null==L?void 0:L.email)||"selected cashier",")"]})]})]}),(0,r.jsxs)(f.ck,{children:[(0,r.jsx)(f.Zr,{onClick:()=>w(null),children:"Cancel"}),(0,r.jsx)(f.Rx,{onClick:z,children:"Confirm Reset"})]})]})})]})}},27038:(e,t,a)=>{Promise.resolve().then(a.bind(a,2500))},30285:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,r:()=>i});var r=a(95155);a(12115);var s=a(99708),n=a(74466),l=a(59434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:a,size:n,asChild:o=!1,...d}=e,c=o?s.DX:"button";return(0,r.jsx)(c,{"data-slot":"button",className:(0,l.cn)(i({variant:a,size:n,className:t})),...d})}},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(52596),s=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},85127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>l,BF:()=>i,Hj:()=>o,XI:()=>n,nA:()=>c,nd:()=>d});var r=a(95155);a(12115);var s=a(59434);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",t),...a})})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 *:[[role=checkbox]]:translate-y-0.5",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 *:[[role=checkbox]]:translate-y-0.5",t),...a})}},90010:(e,t,a)=>{"use strict";a.d(t,{$v:()=>m,EO:()=>h,Lt:()=>i,Rx:()=>f,Zr:()=>p,ck:()=>x,r7:()=>g,tv:()=>o,wd:()=>u});var r=a(95155);a(12115);var s=a(62278),n=a(59434),l=a(30285);function i(e){let{...t}=e;return(0,r.jsx)(s.bL,{"data-slot":"alert-dialog",...t})}function o(e){let{...t}=e;return(0,r.jsx)(s.l9,{"data-slot":"alert-dialog-trigger",...t})}function d(e){let{...t}=e;return(0,r.jsx)(s.ZL,{"data-slot":"alert-dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,r.jsx)(s.hJ,{"data-slot":"alert-dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function h(e){let{className:t,...a}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{}),(0,r.jsx)(s.UC,{"data-slot":"alert-dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function u(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function x(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function g(e){let{className:t,...a}=e;return(0,r.jsx)(s.hE,{"data-slot":"alert-dialog-title",className:(0,n.cn)("text-lg font-semibold",t),...a})}function m(e){let{className:t,...a}=e;return(0,r.jsx)(s.VY,{"data-slot":"alert-dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function f(e){let{className:t,...a}=e;return(0,r.jsx)(s.rc,{className:(0,n.cn)((0,l.r)(),t),...a})}function p(e){let{className:t,...a}=e;return(0,r.jsx)(s.ZD,{className:(0,n.cn)((0,l.r)({variant:"outline"}),t),...a})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2848,6671,7849,2898,6874,5821,8804,8441,1684,7358],()=>t(27038)),_N_E=e.O()}]);