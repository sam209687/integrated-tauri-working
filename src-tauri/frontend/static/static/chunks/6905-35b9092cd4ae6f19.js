(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6905],{2281:(e,r,a)=>{"use strict";a.d(r,{default:()=>_});var t=a(95155),l=a(12115),c=a(62177),s=a(35695),n=a(63560),i=a(56671),d=a(51154),o=a(34477);let u=(0,o.createServerReference)("7f7ced08538c88658eeb6ec7aa3f02bbff955e8de6",o.callServer,void 0,o.findSourceMapURL,"generateProductCodeForUI"),p=(0,o.createServerReference)("7fc1cd08948edbf1985ccc9089e02628ea7c8ece33",o.callServer,void 0,o.findSourceMapURL,"updateProduct"),x=(0,o.createServerReference)("7f771d5832b22c83e45ee6e80c445b73f616b27614",o.callServer,void 0,o.findSourceMapURL,"createProduct");var h=a(99919),f=a(65453),m=a(75626),g=a(50691);let v=(0,o.createServerReference)("7ff45b45f74dc82f8389c194031b16a59e0c6290d0",o.callServer,void 0,o.findSourceMapURL,"getBrands"),b=(0,o.createServerReference)("7fe3a49d23046d7e7620c05ac4a98240cf893b097e",o.callServer,void 0,o.findSourceMapURL,"getTaxes"),j=(0,o.createServerReference)("7f432a17c8f7e68be43bb9bcaebbdc3da18e9044c8",o.callServer,void 0,o.findSourceMapURL,"getCurrencySymbol"),y=(0,f.v)(e=>({products:[],categories:[],brands:[],taxes:[],isLoading:!1,currencySymbol:"₹",fetchProducts:async()=>{e({isLoading:!0});try{let r=await (0,m.d)();r.success?e({products:r.data,isLoading:!1}):(i.oR.error(r.message),e({isLoading:!1,products:[]}))}catch(r){console.error("Failed to fetch products:",r),e({isLoading:!1,products:[]})}},fetchFormData:async()=>{e({isLoading:!0});try{let[r,a,t,l]=await Promise.all([(0,g.b)(),v(),b(),j()]);e({categories:r.success?r.data:[],brands:a.success?a.data:[],taxes:t.success?t.data:[],currencySymbol:l.success?l.data:"₹",isLoading:!1})}catch(r){console.error("Failed to fetch form data:",r),e({isLoading:!1})}},addProduct:r=>{e(e=>({products:[...e.products,r]}))},updateProduct:r=>{e(e=>({products:e.products.map(e=>e._id===r._id?r:e)}))},removeProduct:r=>{e(e=>({products:e.products.filter(e=>e._id!==r)}))}}));var S=a(30285),C=a(17759),w=a(62523),R=a(59409),N=a(22346),P=a(59434);function L(e){let{className:r,...a}=e;return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,P.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...a})}let _=e=>{var r,a,o,f,m,g,v,b,j;let{initialData:P}=e,_=(0,s.useRouter)(),[M,k]=(0,l.useTransition)(),[U,z]=(0,l.useState)(!1),{categories:A,brands:B,taxes:I,fetchFormData:E,isLoading:J}=y(),V=!!P,F="w-full [appearance:textfield] [&::-webkit-outer-spin-button]:m-0 [&::-webkit-inner-spin-button]:m-0",$=(0,c.mN)({resolver:(0,n.u)(h.HU),defaultValues:{category:(null==P||null==(a=P.category)||null==(r=a._id)?void 0:r.toString())||(null==P||null==(o=P.category)?void 0:o.toString())||"",brand:(null==P||null==(m=P.brand)||null==(f=m._id)?void 0:f.toString())||(null==P||null==(g=P.brand)?void 0:g.toString())||"",productCode:(null==P?void 0:P.productCode)||"",productName:(null==P?void 0:P.productName)||"",description:(null==P?void 0:P.description)||"",tax:(null==P||null==(b=P.tax)||null==(v=b._id)?void 0:v.toString())||(null==P||null==(j=P.tax)?void 0:j.toString())||"",purchasePrice:(null==P?void 0:P.purchasePrice)||0,sellingPrice:(null==P?void 0:P.sellingPrice)||0}}),{watch:O,setValue:T}=$,q=O("category");(0,l.useEffect)(()=>{E()},[E]),(0,l.useEffect)(()=>{q&&!V&&(z(!0),(async()=>{try{let e=await u(q);e.success&&e.data?T("productCode",e.data):i.oR.error(e.message||"Failed to generate product code.")}catch(e){i.oR.error("Error generating product code."),console.error(e)}finally{z(!1)}})())},[q,T,V]);let D=async e=>{k(async()=>{let r={...e,productCode:e.productCode||""},a=V?await p(P._id,r):await x(r);a.success?(i.oR.success(a.message),_.push("/admin/products")):i.oR.error(a.message)})};return J?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(d.A,{className:"h-8 w-8 animate-spin"})}):(0,t.jsx)(C.lV,{...$,children:(0,t.jsxs)("form",{onSubmit:$.handleSubmit(D),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:$.control,name:"productName",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Name"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.p,{placeholder:"e.g., Sunflower Oil",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:$.control,name:"category",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Category"}),(0,t.jsxs)(R.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.bq,{children:(0,t.jsx)(R.yv,{placeholder:"Select a category"})})}),(0,t.jsx)(R.gC,{children:A.map(e=>(0,t.jsx)(R.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:$.control,name:"brand",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Brand"}),(0,t.jsxs)(R.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.bq,{children:(0,t.jsx)(R.yv,{placeholder:"Select a brand"})})}),(0,t.jsx)(R.gC,{children:B.map(e=>(0,t.jsx)(R.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(C.zB,{control:$.control,name:"description",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Description"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(L,{placeholder:"Describe the product...",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:$.control,name:"tax",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Tax"}),(0,t.jsxs)(R.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.bq,{children:(0,t.jsx)(R.yv,{placeholder:"Select a tax"})})}),(0,t.jsx)(R.gC,{children:I.map(e=>(0,t.jsx)(R.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsx)(N.Separator,{className:"my-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mt-6",children:"Inventory & Pricing"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:$.control,name:"productCode",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Code"}),(0,t.jsx)(C.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(w.p,{...r,disabled:!0,className:"pr-8"}),U&&(0,t.jsx)(d.A,{className:"absolute right-2 top-2 h-4 w-4 animate-spin text-gray-400"})]})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:$.control,name:"purchasePrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Purchase Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:$.control,name:"sellingPrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Selling / Board Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-8",children:[(0,t.jsx)(S.$,{type:"button",variant:"outline",onClick:()=>_.back(),disabled:M,children:"Cancel"}),(0,t.jsx)(S.$,{type:"submit",disabled:M,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait..."]}):V?"Update Product":"Add Product"})]})]})})}},14050:(e,r,a)=>{"use strict";a.d(r,{b:()=>o});var t=a(12115);a(47650);var l=a(99708),c=a(95155),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let a=(0,l.TL)(`Primitive.${r}`),s=t.forwardRef((e,t)=>{let{asChild:l,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,c.jsx)(l?a:r,{...s,ref:t})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{}),n="horizontal",i=["horizontal","vertical"],d=t.forwardRef((e,r)=>{var a;let{decorative:t,orientation:l=n,...d}=e,o=(a=l,i.includes(a))?l:n;return(0,c.jsx)(s.div,{"data-orientation":o,...t?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...d,ref:r})});d.displayName="Separator";var o=d},19946:(e,r,a)=>{"use strict";a.d(r,{A:()=>u});var t=a(12115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),s=e=>{let r=c(e);return r.charAt(0).toUpperCase()+r.slice(1)},n=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()},i=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,r)=>{let{color:a="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:s,className:o="",children:u,iconNode:p,...x}=e;return(0,t.createElement)("svg",{ref:r,...d,width:l,height:l,stroke:a,strokeWidth:s?24*Number(c)/Number(l):c,className:n("lucide",o),...!u&&!i(x)&&{"aria-hidden":"true"},...x},[...p.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(u)?u:[u]])}),u=(e,r)=>{let a=(0,t.forwardRef)((a,c)=>{let{className:i,...d}=a;return(0,t.createElement)(o,{ref:c,iconNode:r,className:n("lucide-".concat(l(s(e))),"lucide-".concat(e),i),...d})});return a.displayName=s(e),a}},34477:(e,r,a)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var a in r)Object.defineProperty(e,a,{enumerable:!0,get:r[a]})}(r,{callServer:function(){return t.callServer},createServerReference:function(){return c},findSourceMapURL:function(){return l.findSourceMapURL}});let t=a(53806),l=a(31818),c=a(34979).createServerReference},45312:(e,r,a)=>{Promise.resolve().then(a.bind(a,2281))},50691:(e,r,a)=>{"use strict";a.d(r,{b:()=>l});var t=a(34477);let l=(0,t.createServerReference)("7f5604b32eb72c3313cbc28a49088b5ae870187629",t.callServer,void 0,t.findSourceMapURL,"getCategories")},51154:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}}]);