(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2684],{1171:(e,r,a)=>{"use strict";a.d(r,{b:()=>l});var t=a(34477);let l=(0,t.createServerReference)("7f70348f43cb5017c8c25bbf38596e3cdb85209db0",t.callServer,void 0,t.findSourceMapURL,"getCategories")},19946:(e,r,a)=>{"use strict";a.d(r,{A:()=>u});var t=a(12115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),d=e=>{let r=s(e);return r.charAt(0).toUpperCase()+r.slice(1)},c=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()},n=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,r)=>{let{color:a="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:d,className:o="",children:u,iconNode:p,...x}=e;return(0,t.createElement)("svg",{ref:r,...i,width:l,height:l,stroke:a,strokeWidth:d?24*Number(s)/Number(l):s,className:c("lucide",o),...!u&&!n(x)&&{"aria-hidden":"true"},...x},[...p.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(u)?u:[u]])}),u=(e,r)=>{let a=(0,t.forwardRef)((a,s)=>{let{className:n,...i}=a;return(0,t.createElement)(o,{ref:s,iconNode:r,className:c("lucide-".concat(l(d(e))),"lucide-".concat(e),n),...i})});return a.displayName=d(e),a}},34477:(e,r,a)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var a in r)Object.defineProperty(e,a,{enumerable:!0,get:r[a]})}(r,{callServer:function(){return t.callServer},createServerReference:function(){return s},findSourceMapURL:function(){return l.findSourceMapURL}});let t=a(53806),l=a(31818),s=a(34979).createServerReference},45312:(e,r,a)=>{Promise.resolve().then(a.bind(a,73805))},51154:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},73805:(e,r,a)=>{"use strict";a.d(r,{default:()=>_});var t=a(95155),l=a(12115),s=a(62177),d=a(35695),c=a(63560),n=a(56671),i=a(51154),o=a(34477);let u=(0,o.createServerReference)("7f178dcbda210bfead303b847e09850ae7de498006",o.callServer,void 0,o.findSourceMapURL,"generateProductCodeForUI"),p=(0,o.createServerReference)("7fbdb6845d3a35b08b595ac71f89a084f17f869915",o.callServer,void 0,o.findSourceMapURL,"updateProduct"),x=(0,o.createServerReference)("7f4a6f3dc864bc0aa2a14347d0159e79b0bd54792c",o.callServer,void 0,o.findSourceMapURL,"createProduct");var h=a(99919),f=a(65453),g=a(19753),m=a(1171);let v=(0,o.createServerReference)("7f380a9c72212f05b93535e3ac0ba0b8f8dce54ef5",o.callServer,void 0,o.findSourceMapURL,"getBrands"),b=(0,o.createServerReference)("7fde47e1b43af07885fd8e6fd717e081ec2100ea21",o.callServer,void 0,o.findSourceMapURL,"getTaxes"),j=(0,o.createServerReference)("7f5a71b55cb00d20f4bd3adfc2338c70c9a1369e82",o.callServer,void 0,o.findSourceMapURL,"getCurrencySymbol"),S=(0,f.v)(e=>({products:[],categories:[],brands:[],taxes:[],isLoading:!1,currencySymbol:"₹",fetchProducts:async()=>{e({isLoading:!0});try{let r=await (0,g.d)();r.success?e({products:r.data,isLoading:!1}):(n.oR.error(r.message),e({isLoading:!1,products:[]}))}catch(r){console.error("Failed to fetch products:",r),e({isLoading:!1,products:[]})}},fetchFormData:async()=>{e({isLoading:!0});try{let[r,a,t,l]=await Promise.all([(0,m.b)(),v(),b(),j()]);e({categories:r.success?r.data:[],brands:a.success?a.data:[],taxes:t.success?t.data:[],currencySymbol:l.success?l.data:"₹",isLoading:!1})}catch(r){console.error("Failed to fetch form data:",r),e({isLoading:!1})}},addProduct:r=>{e(e=>({products:[...e.products,r]}))},updateProduct:r=>{e(e=>({products:e.products.map(e=>e._id===r._id?r:e)}))},removeProduct:r=>{e(e=>({products:e.products.filter(e=>e._id!==r)}))}}));var y=a(30285),C=a(17759),R=a(62523),w=a(59409),N=a(22346),P=a(59434);function L(e){let{className:r,...a}=e;return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,P.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...a})}let _=e=>{var r,a,o,f,g,m,v,b,j;let{initialData:P}=e,_=(0,d.useRouter)(),[M,k]=(0,l.useTransition)(),[U,z]=(0,l.useState)(!1),{categories:A,brands:B,taxes:I,fetchFormData:E,isLoading:J}=S(),V=!!P,F="w-full [appearance:textfield] [&::-webkit-outer-spin-button]:m-0 [&::-webkit-inner-spin-button]:m-0",O=(0,s.mN)({resolver:(0,c.u)(h.HU),defaultValues:{category:(null==P||null==(a=P.category)||null==(r=a._id)?void 0:r.toString())||(null==P||null==(o=P.category)?void 0:o.toString())||"",brand:(null==P||null==(g=P.brand)||null==(f=g._id)?void 0:f.toString())||(null==P||null==(m=P.brand)?void 0:m.toString())||"",productCode:(null==P?void 0:P.productCode)||"",productName:(null==P?void 0:P.productName)||"",description:(null==P?void 0:P.description)||"",tax:(null==P||null==(b=P.tax)||null==(v=b._id)?void 0:v.toString())||(null==P||null==(j=P.tax)?void 0:j.toString())||"",purchasePrice:(null==P?void 0:P.purchasePrice)||0,sellingPrice:(null==P?void 0:P.sellingPrice)||0}}),{watch:$,setValue:q}=O,D=$("category");(0,l.useEffect)(()=>{E()},[E]),(0,l.useEffect)(()=>{D&&!V&&(z(!0),(async()=>{try{let e=await u(D);e.success&&e.data?q("productCode",e.data):n.oR.error(e.message||"Failed to generate product code.")}catch(e){n.oR.error("Error generating product code."),console.error(e)}finally{z(!1)}})())},[D,q,V]);let T=async e=>{k(async()=>{let r={...e,productCode:e.productCode||""},a=V?await p(P._id,r):await x(r);a.success?(n.oR.success(a.message),_.push("/admin/products")):n.oR.error(a.message)})};return J?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(i.A,{className:"h-8 w-8 animate-spin"})}):(0,t.jsx)(C.lV,{...O,children:(0,t.jsxs)("form",{onSubmit:O.handleSubmit(T),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"productName",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Name"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{placeholder:"e.g., Sunflower Oil",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"category",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Category"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a category"})})}),(0,t.jsx)(w.gC,{children:A.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"brand",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Brand"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a brand"})})}),(0,t.jsx)(w.gC,{children:B.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"description",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Description"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(L,{placeholder:"Describe the product...",...r,disabled:M})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"tax",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Tax"}),(0,t.jsxs)(w.l6,{onValueChange:r.onChange,defaultValue:r.value,disabled:M,children:[(0,t.jsx)(C.MJ,{children:(0,t.jsx)(w.bq,{children:(0,t.jsx)(w.yv,{placeholder:"Select a tax"})})}),(0,t.jsx)(w.gC,{children:I.map(e=>(0,t.jsx)(w.eb,{value:e._id,children:e.name},e._id))})]}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsx)(N.Separator,{className:"my-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold mt-6",children:"Inventory & Pricing"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(C.zB,{control:O.control,name:"productCode",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Product Code"}),(0,t.jsx)(C.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(R.p,{...r,disabled:!0,className:"pr-8"}),U&&(0,t.jsx)(i.A,{className:"absolute right-2 top-2 h-4 w-4 animate-spin text-gray-400"})]})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"purchasePrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Purchase Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}}),(0,t.jsx)(C.zB,{control:O.control,name:"sellingPrice",render:e=>{let{field:r}=e;return(0,t.jsxs)(C.eI,{children:[(0,t.jsx)(C.lR,{children:"Selling / Board Price"}),(0,t.jsx)(C.MJ,{children:(0,t.jsx)(R.p,{type:"number",step:"0.01",...r,disabled:M,className:F})}),(0,t.jsx)(C.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-8",children:[(0,t.jsx)(y.$,{type:"button",variant:"outline",onClick:()=>_.back(),disabled:M,children:"Cancel"}),(0,t.jsx)(y.$,{type:"submit",disabled:M,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait..."]}):V?"Update Product":"Add Product"})]})]})})}},87489:(e,r,a)=>{"use strict";a.d(r,{b:()=>i});var t=a(12115),l=a(63655),s=a(95155),d="horizontal",c=["horizontal","vertical"],n=t.forwardRef((e,r)=>{var a;let{decorative:t,orientation:n=d,...i}=e,o=(a=n,c.includes(a))?n:d;return(0,s.jsx)(l.sG.div,{"data-orientation":o,...t?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...i,ref:r})});n.displayName="Separator";var i=n}}]);